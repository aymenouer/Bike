!function(){var e=function(e){var t={exports:{}};return e.call(t.exports,t,t.exports),t.exports},f=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),l=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},h=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},u=function s(e,t,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(r===undefined){var o=Object.getPrototypeOf(e);return null===o?undefined:s(o,t,i)}if("value"in r)return r.value;var n=r.get;return n===undefined?undefined:n.call(i)},d=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},r=function(e){return e&&e.__esModule?e:{"default":e}},c=e(function(e,t){"use strict";function i(e,t){!(1<arguments.length&&t!==undefined)||arguments[1]?window.open(e,"adminBarWindow"):window.location.assign(e)}function r(){window.location.reload()}Object.defineProperty(t,"__esModule",{value:!0}),t.redirectToUrl=i,t.refreshPage=r;var o=function(){function n(e){var t=e.targetNode,i=e.iframeRoot,r=e.iframeSrc,o=e.permanentDomain;l(this,n),this.targetNode=t,this.iframeRoot=i,this.iframeSrc=r,this.permanentDomain=o}return f(n,[{key:"createIframe",value:function i(e,t){this.iframe=document.createElement("iframe"),this.iframe.setAttribute("title",e),this.iframe.setAttribute("id",t),this.iframe.setAttribute("src",this.iframeSrc),this.iframe.setAttribute("sandbox","allow-same-origin allow-scripts"),this.iframe.setAttribute("style",this.loadingStyles),this.targetNode.appendChild(this.iframe),this.target=this.iframe.contentWindow}}],[{key:"convertStylesObjectToString",value:function e(t){return Object.keys(t).map(function(e){return e+": "+t[e]+";"}).join(" ")}},{key:"returnObjectValues",value:function r(t){return Object.keys(t).map(function(e){return t[e]})}}]),n}();t["default"]=o});e(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function E(e){var t=e.targetNode,i=e.iframeRoot,r=e.iframeSrc,o=e.previewToken,n=e.themeStoreId,s=e.permanentDomain;l(this,E);var a=d(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,{targetNode:t,iframeRoot:i,iframeSrc:r,permanentDomain:s}));return a.POST_MESSAGE_EVENTS={OPEN_MODAL:"open_modal",CLOSE_MODAL:"close_modal",OPEN_POPOVER:"open_popover",CLOSE_POPOVER:"close_popover",HIDE_IFRAME:"hide_iframe",COPY_SHARE_LINK:"copy_share_link",SET_IFRAME_HEIGHT:"set_iframe_height",CUSTOMIZE_THEME:"customize_theme",PURCHASE_THEME:"purchase_theme",EXIT_PREVIEW:"exit_preview",TEMPLATE_EDITOR_REFRESH_PAGE:'{"key":"pageRefresh"}'},a.previewToken=o,a.themeStoreId=n,a.htmlNode=document.querySelector("html"),a.loadingStyles=E.convertStylesObjectToString({position:"fixed",transform:"translateY(100%)",border:"none"}),a.defaultStyles=E.convertStylesObjectToString({position:"fixed",bottom:0,left:0,"z-index":2147483647,width:"100%",height:a.height+"px",border:"none","box-shadow":"0 -1px 3px rgba(0, 0, 0, 0.2)",overflow:"hidden",transform:"translateY(0)",transition:"transform 300ms"}),a.modalOpenStyles=E.convertStylesObjectToString({position:"fixed",bottom:0,left:0,"z-index":21474836472,width:"100%",height:"100vh",border:"none"}),a}return h(E,e),f(E,[{key:"init",value:function t(){var e=this;u(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"createIframe",this).call(this,"Preview Bar","preview-bar-iframe"),this.iframe.contentWindow.addEventListener("DOMContentLoaded",function(){e.iframe.setAttribute("style",e.defaultStyles)}),this._postMessageBuffer=this.postMessageBuffer.bind(this),window.addEventListener("message",this._postMessageBuffer)}},{key:"teardown",value:function i(){window.removeEventListener("message",this._postMessageBuffer)}},{key:"postMessageBuffer",value:function n(e){var t=e.data.message||e.data,i=e.data.height||60,r=e.data.url,o=e.origin;!t||E.returnObjectValues(this.POST_MESSAGE_EVENTS).indexOf(t)<0||t===this.POST_MESSAGE_EVENTS.TEMPLATE_EDITOR_REFRESH_PAGE&&o!=="https://"+this.permanentDomain||t!==this.POST_MESSAGE_EVENTS.TEMPLATE_EDITOR_REFRESH_PAGE&&o!==this.iframeRoot||(t!==this.POST_MESSAGE_EVENTS.TEMPLATE_EDITOR_REFRESH_PAGE&&this.postTrekkieData(t),this.postMessageHandler(t,i,r,o))}},{key:"postMessageHandler",value:function o(e,t,i,r){switch(e){case this.POST_MESSAGE_EVENTS.OPEN_MODAL:this.iframe.setAttribute("style",this.modalOpenStyles),this.sendPostMessage("modal_opened",r);break;case this.POST_MESSAGE_EVENTS.CLOSE_MODAL:this.iframe.setAttribute("style",this.defaultStyles),this.iframe.style.height=this.height+"px",this.sendPostMessage("modal_closed",r);break;case this.POST_MESSAGE_EVENTS.OPEN_POPOVER:this.iframe.setAttribute("style",this.modalOpenStyles),this.sendPostMessage("popover_opened",r);break;case this.POST_MESSAGE_EVENTS.CLOSE_POPOVER:this.iframe.setAttribute("style",this.defaultStyles),this.iframe.style.height=this.height+"px",this.sendPostMessage("popover_closed",r);break;case this.POST_MESSAGE_EVENTS.HIDE_IFRAME:this.hideIframe();break;case this.POST_MESSAGE_EVENTS.EXIT_PREVIEW:(0,c.redirectToUrl)(i,!1);break;case this.POST_MESSAGE_EVENTS.CUSTOMIZE_THEME:case this.POST_MESSAGE_EVENTS.PURCHASE_THEME:(0,c.redirectToUrl)(i);break;case this.POST_MESSAGE_EVENTS.SET_IFRAME_HEIGHT:this.height=t,this.iframe.style.height=t+"px",this.htmlNode.style.paddingBottom=t+"px";break;case this.POST_MESSAGE_EVENTS.TEMPLATE_EDITOR_REFRESH_PAGE:(0,c.refreshPage)()}}},{key:"sendPostMessage",value:function r(e,t){this.target.postMessage(e,t)}},{key:"hideIframe",value:function s(){this.iframe.setAttribute("style","display: none"),this.htmlNode.style.paddingBottom="0"}},{key:"postTrekkieData",value:function a(e){window.trekkie&&window.trekkie.track("theme_sharing",{action:e,token:this.previewToken,themeStoreId:this.themeStoreId})}}]),E}(r(c)["default"]);t["default"]=i,Shopify.PreviewBarInjector=null!=t["default"]?t["default"]:t})}("undefined"!=typeof global?global:"undefined"!=typeof window&&window);